<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" type="text/css" href="/css/default.css" />
        <link rel="stylesheet" type="text/css" href="/css/post.css" />
        <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
        <script type="text/javascript" src="https://rawgit.com/rob2468/commentme/master/dist/commentme.js"></script>
        <script type="text/javascript" src="/js/post.js"></script>
        <script type="text/javascript">$(document).ready(generateContentsTable);</script>
        <title>{{ page.title }}</title>
    </head>
    <body>
        <div class="header"></div>

        <div class="main">
        {{ content }}

        <div class="comment_area">
        <!-- comment form -->
        <div class="comment_form">
          <form>
            <input type="text" name="display_name" placeholder="姓名"></input>
            <input type="text" name="email" placeholder="电子邮箱"></input>
            <textarea name="content" placeholder="请输入您的评论"></textarea>
            <input type="button" value="提交评论" onclick="submitForm()"></input>
          </form>
        </div>
        <!-- comments -->
        {% assign pageid = page.id %}
        {%if site.data.comments[pageid] %}
            {% assign sorted_comments = (site.data.comments[pageid] | sort: 'date') %}
        {% endif %}
        {% for c in sorted_comments %}
          <div>
              <p>{{ c.author.display_name }} on {{ c.date | date_to_string }}</p>
              <p>{{ c.content | newline_to_br }}</p>
          </div>
        {% else %}
            这篇文章暂没有评论。
        {% endfor %}
        </div>

        <script>
        function submitForm() {
          var TOKEN = "token f3257ed1efef5c1ad10d7337636c3b375735270a";
          var BRANCH_NAME = "comments";
          var OWNER_NAME = "rob2468";
          var REPO_NAME = "rob2468.github.io";
          var pageID = "{{ pageid }}";
          var email = $("input[name='email']").val();
          var dateObj = new Date();
          var date = dateObj.toDateString();
          var display_name = $("input[name='display_name']").val();
          var content = $("textarea[name='content']").val();
          commentme_submitComment(TOKEN, BRANCH_NAME, OWNER_NAME, REPO_NAME, pageID, email, date, display_name, content)
        }
        </script>
        </div><!-- main -->

        <div class="footer">
            <p>powered by github</p>
        </div>
    </body>
</html>
